!function(t){t.regex=t.regex||{},t.extend(t.regex,{isEmail:function(t){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(t)},isPhone:function(t){return/^((\d{11})|(\d{3}-\d{8})|(\d{4}-\d{7})|(\d{3}-\d{4}-\d{4}))$/.test(t)},isMobile:function(t){return/^(13[0-9]|15[012356789]|18[0-9]|14[57]|170)[0-9]{8}$/.test(t)},isYidongNumber:function(t){return/^1(3[4-9]|4[7]|5[012789]|8[2378])\d{8}$/.test(t)},isDianxinNumber:function(t){return/^1([35]3|8[09])\d{8}$/.test(t)},isLianTongNumber:function(t){return/^1(3[0-2]|4[5]|5[56]|8[0156])\d{8}$/.test(t)},isIDCard:function(t){return/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}(\d|(x|X))$/.test(t)},isPostcode:function(t){return/^\d{6}$/.test(t)},isQq:function(t){return/^\d{5,}$/.test(t)},isUrl:function(t){if(!t)return!1;var n=t.split("?")[0].split("#")[0],e="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$",r=new RegExp(e);return r.test(n)}})}(jQuery),function(){$(function(){var t,n,e,r,i,u,o,s,a,d,l,c;return s=$("#name"),u=$("#email"),o=$("#mobile"),a=$("#password"),r=$("#confirm_password"),i=function(t,n){return setTimeout(n,t)},e=function(){return 0===$.trim(s.val()).length?void t(s,"\u8bf7\u8ba4\u771f\u586b\u5199\u60a8\u7684\u59d3\u540d"):0!==$.trim(u.val()).length&&$.regex.isEmail(u.val())?0!==$.trim(o.val()).length&&$.regex.isMobile(o.val())?l():void t(o,"\u60a8\u7684\u624b\u673a\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e"):void t(u,"\u60a8\u7684\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e")},n=function(){return $.trim(a.val()).length>0?a.val()!==r.val()?void t(r,"\u4e24\u6b21\u5bc6\u7801\u4e0d\u5339\u914d"):c():!1},c=function(){return $.ajax({data:{password:$.trim(a.val())},url:"/user/users/update_pwd",method:"POST",success:function(){return $(".pass-submit").removeClass("info").addClass("success").text("\u4fee\u6539\u6210\u529f!"),i(2e3,function(){return window.location.reload()})}})},l=function(){return $.post("/user/users/update_info",$("form.info").serialize(),function(n){return n.success?($("button.info-submit").removeClass("info").addClass("success").text("\u4fee\u6539\u6210\u529f!"),i(2e3,function(){return window.location.reload()})):"error_5"===n.value.error_code?t(u,"\u8be5\u90ae\u7bb1\u5df2\u7ecf\u5b58\u5728!"):t(o,"\u8be5\u624b\u673a\u53f7\u5df2\u7ecf\u5b58\u5728!")})},t=function(t,n){var e;return t.prev("label").find("span").length>0||(e="<span>"+n+"</span>",t.prev("label").append(e),t.attr("aria-invalid",!0)),$("html, body").animate({scrollTop:0},500)},d=function(t){return t.removeAttr("aria-invalid"),t.prev("label").find("span").remove()},$("input").focus(function(){return d($(this))}),$("button.info-submit").click(function(t){return t.preventDefault(),e()}),$("form.info input,textarea").keydown(function(t){return 13===t.witch?$("button.info-submit").click():void 0}),$("form.pwd button.pass-submit").click(function(t){return t.preventDefault(),n()})})}.call(this);