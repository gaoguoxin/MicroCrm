(function(){$(function(){var t,a,n,e;return $("#search_start,#search_end").datepicker({dateFormat:"yy-mm-dd",showAnim:"show"}),e=function(t){return $.fancybox.open($(".feedback-box"),{padding:0,autoSize:!0,minWidth:1e3,minHeight:600,openEffect:"none",closeEffect:"none",helpers:{overlay:{locked:!1,closeClick:!1,css:{background:"rgba(51, 51, 51, 0.2)"}}},beforeShow:function(){return $(".feedback-box .content table tbody").html(""),n(t)}})},n=function(t){return $.get("/admin/feedbacks/get_feed_info",{cid:t},function(t){return t.success?$.each(t.value,function(t,a){var n;return n="<tr> <td>"+a.uname+"</td> <td class='point'  data-uid="+a.uid+" data-cid="+a.cid+" data-q='question_1' data-id="+a.f_id+" ><span>"+a.q_1+"\u5206</span><input type='number' name='point' maxlength=2 value="+a.q_1+"></td> <td class='point'  data-uid="+a.uid+" data-cid="+a.cid+" data-q='question_2' data-id="+a.f_id+" ><span>"+a.q_2+"\u5206</span><input type='number' name='point' maxlength=2 value="+a.q_2+"></td> <td class='point'  data-uid="+a.uid+" data-cid="+a.cid+" data-q='question_3' data-id="+a.f_id+" ><span>"+a.q_3+"\u5206</span><input type='number' name='point' maxlength=2 value="+a.q_3+"></td> <td class='point'  data-uid="+a.uid+" data-cid="+a.cid+" data-q='question_4' data-id="+a.f_id+" ><span>"+a.q_4+"\u5206</span><input type='number' name='point' maxlength=2 value="+a.q_4+"></td> <td class='point'  data-uid="+a.uid+" data-cid="+a.cid+" data-q='question_5' data-id="+a.f_id+" ><span>"+a.q_5+"\u5206</span><input type='number' name='point' maxlength=2 value="+a.q_5+"></td> <td class='tot'>"+a.tot+"\u5206</td> <td class='status'>"+a.status+"</td> <td class='check' ><ul class='checklist turquoise large'><li data-uid="+a.uid+" data-cid="+a.cid+" data-id="+a.f_id+" >\u5ba1\u6838</li></ul></td> </tr>",$(".feedback-box .content table tbody").append(n)}):void 0})},t=function(t){var a,n,e,d;return a=t.parents("td").data("cid"),d=t.parents("td").data("uid"),e=t.parents("td").data("q"),n=t.val(),$.post("/admin/feedbacks/change_point",{cid:a,uid:d,q:e,p:n},function(a){return a.success?(t.val(n).hide().siblings("span").text(n+"\u5206").show(),t.parents("tr").find(".tot").text(a.value+"\u5206"),t.parents("tr").find(".status").text("\u7b49\u5f85\u5ba1\u6838")):void 0})},a=function(t,a){var n,e,d,i,c;return n=a.parents("td").data("cid"),c=a.parents("td").data("uid"),a.hasClass("pass")?(d="pass",i="\u5ba1\u6838\u901a\u8fc7",e="pass"):(d="refuse",i="\u5ba1\u6838\u62d2\u7edd",e="refuse"),$.post("/admin/feedbacks/check_feedback",{data:t,r:e},function(a){return a.success?$.each(t,function(t,a){var n,e,d;return e=$(".checklist li[data-uid='"+a.uid+"']"),d=e.parents("td"),n=d.prev("td"),"\u5c1a\u672a\u53cd\u9988"!==n.text()?n.text(i):void 0}):void 0})},$("body").on("click","a.show-feedback",function(){var t;return t=$(this).data("id"),e(t)}),$("body").on("click","button.close-btn",function(){return $.fancybox.close()}),$("body").on("click",".search-feedbacks",function(t){var a;return t.preventDefault(),a=$("form.search-form").serialize(),$.get("/admin/feedbacks",a,function(){})}),$("body").on("click",".pagination a",function(){var t,a,n,e,d,i,c,s;return!$(this).hasClass("disabled")&&(i=$(this).data("page"),c=$(this).data("status"),a=$(this).data("code"),s=$(this).data("t"),d=$(this).data("name"),t=$(this).data("city"),n=$(this).data("content"),e={page:i,status:c,code:a,t:s,name:d,city:t,content:n},i)?$.get("/admin/feedbacks",e,function(){}):void 0}),$("body").on("click","td.point",function(){return $(this).find("span").hide().siblings("input").show()}),$("body").on("keydown","td.point input",function(a){return 13===a.which?t($(this)):void 0}),$("body").on("blur","td.point input",function(){return t($(this))}),$("body").on("click",".check-tool .checklist li",function(){return"true"===$(this).attr("aria-checked")?$("td.check li").attr("aria-checked",!0):$("td.check li").attr("aria-checked",!1)}),$("body").on("click","button.pass,button.refuse",function(){var t;return $('td.check li[aria-checked="true"]').length>0&&(t=[],$('td.check li[aria-checked="true"]').each(function(){return t.push({cid:$(this).data("cid"),uid:$(this).data("uid")})}),t.length>0)?a(t,$(this)):void 0})})}).call(this);