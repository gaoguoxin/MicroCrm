!function(n){n.regex=n.regex||{},n.extend(n.regex,{isEmail:function(n){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(n)},isPhone:function(n){return/^((\d{11})|(\d{3}-\d{8})|(\d{4}-\d{7})|(\d{3}-\d{4}-\d{4}))$/.test(n)},isMobile:function(n){return/^(13[0-9]|15[012356789]|18[0-9]|14[57]|170)[0-9]{8}$/.test(n)},isYidongNumber:function(n){return/^1(3[4-9]|4[7]|5[012789]|8[2378])\d{8}$/.test(n)},isDianxinNumber:function(n){return/^1([35]3|8[09])\d{8}$/.test(n)},isLianTongNumber:function(n){return/^1(3[0-2]|4[5]|5[56]|8[0156])\d{8}$/.test(n)},isIDCard:function(n){return/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}(\d|(x|X))$/.test(n)},isPostcode:function(n){return/^\d{6}$/.test(n)},isQq:function(n){return/^\d{5,}$/.test(n)},isUrl:function(n){if(!n)return!1;var e=n.split("?")[0].split("#")[0],t="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$",a=new RegExp(t);return a.test(e)}})}(jQuery),function(){$(function(){var n,e,t,a,i;return $("#search_start,#search_end").datepicker({dateFormat:"yy-mm-dd",showAnim:"show"}),e=function(n,e){return setTimeout(e,n)},t=function(n){return $(".flash-notice").text(n).addClass("animated bounceInRight").show(),$("html, body").animate({scrollTop:0},500),e(2e3,function(){return window.location.reload()})},n=function(n){var e,t;if(t=$.trim($("#name").val()),e=$.trim($("#manager").val()),t.length<=0)return $("#name").parents(".padded").addClass("invalid").removeClass("valid"),void $("html, body").animate({scrollTop:0},500);if(t.indexOf("\u5176\u4ed6")<0){if(e.length<=0)return $("#manager").parents(".padded").addClass("invalid").removeClass("valid"),void $("html, body").animate({scrollTop:0},500);$(".invalid").removeClass("invalid")}return i(n)},a=function(){return $(".flash-notice").removeClass("animated bounceInRight").addClass("animated bounceOutRight")},i=function(n){var e,a,i;return a=$("form.new-company").serialize(),n.hasClass("upd")?(e="/admin/companies/update_info",i="\u5355\u4f4d\u4fe1\u606f\u4fee\u6539\u6210\u529f\uff01"):(e="/admin/companies",i="\u65b0\u5355\u4f4d\u521b\u5efa\u6210\u529f,\u70b9\u51fb\u5217\u8868\u8fdb\u884c\u67e5\u770b!"),$.post(e,a,function(n){return n.success?t(i):void 0})},$("body").on("click",".tab-nav:last",function(){return $.get("/admin/companies/new",{},function(){})}),$("body").on("click",".search-submit",function(n){var e;return n.preventDefault(),e=$("form.search-form").serialize(),$.get("/admin/companies",e,function(){})}),$("body").on("click","td a.delete-company",function(){var n,e;return e=$(this).parents("tr"),n=$(this).data("cid"),$.get("/admin/companies/delete",{id:n},function(n){return n.success?e.remove():void 0})}),$("body").on("click",".pagination a",function(){var n,e,t,a,i,r,o;return!$(this).hasClass("disabled")&&(t=$(this).data("page"),r=$(this).data("status"),e=$(this).data("level"),o=$(this).data("type"),i=$(this).data("name"),a=$(this).data("account"),n={page:t,search_status:r,search_level:e,search_type:o,search_name:i,search_account:a},t)?$.get("/admin/companies",n,function(){}):void 0}),$("body").on("focus","form.new-company input",function(){return $(this).parents(".padded").removeClass("invalid").removeClass("valid")}),$("body").on("click",".search-manager",function(){var n,e,t,a;return n=$(this),t=$.trim($("#manager").val()),$.regex.isMobile(t)||$.regex.isEmail(t)?(e={account:t},$.get("/admin/companies/search_manager",e,function(e){return e.success?e.value?(n.parents(".padded").addClass("valid"),n.text("\u5339\u914d\u6210\u529f!")):(n.parents(".padded").addClass("invalid"),n.text("\u4e0d\u5b58\u5728\uff0c\u521b\u5efa?")):void 0})):("function"==typeof(a=$("form.new-company #name").val()).indexOf?a.indexOf("\u5176\u4ed6"):void 0)>=0?void 0:$(this).parents(".padded").addClass("invalid")}),$("body").on("keydown","form.new-company #manager",function(n){return 9===n.which?$(".search-manager").click():void 0}),$("body").on("focusout","form.new-company #manager",function(){return $(".search-manager").click()}),$("body").on("click","form.new-company .info-submit",function(e){var t;return t=$(this),e.preventDefault(),n(t)}),$("body").on("keydown","form.new-company #description",function(n){return 13===n.which?$("form.new-company .info-submit").click():void 0}),$("body").on("click","a.edit-company",function(){var n;return n=$(this).attr("id"),$.get("/admin/companies/"+n+"/edit",{},function(){})})})}.call(this);