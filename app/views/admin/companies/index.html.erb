<% content_for :app_head do %>
  <%= stylesheet_link_tag    "pages/admin/companies-bundle" %>
  <%= javascript_include_tag "pages/admin/companies-bundle" %>
  <script type="text/javascript">
  </script>
  <%= yield :head %>
<% end %>


<% content_for :left_side do %>
  <%= render :partial => 'admin/partical/left_side' %>
<% end %>

<% content_for :right_side do %>
  <div class="flash-notice row success double-padded"></div>
  <div class="row right-head triple-pad-left triple-pad-right">
    <span class="fa fa-flag-o"></span><span class="locate">单位管理<i class="fa fa-angle-double-right"></i>单位列表</span>
  </div>
  <div class="row right-notice triple-pad-left triple-pad-right">
    <div class="notice-content double-gap-top double-gap-bottom double-pad-left pad-top pad-bottom">
      <i class="fa fa-info"></i>
      <span>增加/删除/修改单位，请确认是否已增加了“其他”这个特殊的单位</span>
    </div>
  </div>
  <div class="row right-main triple-pad-left">
    <div class="tabs ipad">
      <ul role="tablist">
        <li role="tab" aria-controls="#tab1" class='one fourth tab-nav'>单位列表</li>
        <% if current_user.is_admin? %>
          <li role="tab" aria-controls="#tab2" class='one fourth tab-nav'>新增/编辑&nbsp;单位</li>
        <% end %>
      </ul>
      <div id="tab1" role="tabpanel">
        <div class="search-container">
          <form class='info search-form'>
              <div class="row">
                <div class="one fourth padded">
                  <input id="search_name" name='search_name' type="text" placeholder="企业名称">
                </div>
                <div class="one fourth padded">
                  <input id="search_account" name='search_account'  type="text" placeholder="管理员邮箱/手机号">
                </div>
                <div class="one fourth padded">
                  <input id="search_start" name='search_start' type="text" placeholder="起始时间">
                </div>
                <div class="one fourth padded">
                  <input id="search_end" name='search_end' type="text" placeholder="结束时间">
                </div>                                
              </div>
              <div class="row">
                <div class="one fourth padded">
                  <span class="select-wrap">
                    <select class="unselected" name="search_status" id='search_status'>
                      <option value="" disabled="" selected="">合作状态</option>
                      <% Company::STATUS_HASH.each_pair do |k,v| %>
                        <option value="<%= k %>" <% if params[:status] == k %>selected='selected' <% end %> ><%= v %></option>
                      <% end %>
                    </select>
                  </span>                 
                </div>
                <div class="one fourth padded">
                  <span class="select-wrap">
                    <select class="unselected" name="search_type" id="search_type">
                      <option value="" disabled="" selected="">合作类型</option>
                      <% Company::TYPE_HASH.each_pair do |k,v| %>
                        <option value="<%= k %>" <% if params[:type] == k %> selected='selected'<% end %> ><%= v %></option>
                      <% end %>
                    </select>
                  </span>
                </div>
                <div class="one fourth padded">
                  <span class="select-wrap">
                    <select class="unselected" name="search_level" id="search_level">
                      <option value="" disabled="" selected="">等级</option>
                      <% Company::LEVEL_ARRAY.each do |level| %>
                        <option value="<%= level %>" <% if params[:level] == level %>selected='selected'<% end%> ><%= level %></option>
                      <% end %>
                    </select>
                  </span>
                </div>
                <div class="one fourth padded">
                  <button class="block info search-submit">搜索</button>
                </div> 
              </div>
          </form>
        </div>
        <table class="responsive responsiveTable  <%= @companies.length > 0 ? 'info' : 'error' %>" data-max="15">
          <thead>
            <tr>
              <th>名称</th>
              <th>管理员</th>
              <th>合作类型</th>
              <th>等级</th>
              <th>合作状态</th>
              <th>有效报名<br />人天</th>
              <th>创建时间</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <%= render :partial => '/admin/companies/table',:locals => {:companies => @companies}%>
          </tbody>
        </table>
        <div class="page-container">
          <%= admin_paginator_ajax('company',@companies,{:status => params[:search_status],:level => params[:search_level],:type => params[:search_type],:name => params[:search_name],:account => params[:search_account]}) %>
        </div>
      </div>
      <div id="tab2" role="tabpanel">
        <form class='info new-company'>
          <fieldset>
            <legend>information</legend>
            <div class='form-detail'>
              <%= render :partial => '/admin/companies/form',:locals => {:company => @company}%>
            </div>
            <% if current_user.is_admin? %>
              <button class="block info info-submit">提交</button>
            <% end %>
          </fieldset>
        </form> 
      </div>
    </div>
  </div>
<% end %>
